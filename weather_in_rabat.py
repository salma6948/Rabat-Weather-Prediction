# -*- coding: utf-8 -*-
"""weather in rabat.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1zsCP5V6dZ3QskD5vBarNA1sYTRVN6ujK

# **Importing libraries**
"""

!pip install neuralprophet

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import pickle
from neuralprophet import NeuralProphet

"""# **Data Processing**"""

df = pd.read_csv('Rabat weather.csv')
df.head()

df.dtypes

#converting the time column into a datetime type
df['time'] = pd.to_datetime(df['time'], format='mixed')
df.dtypes

plt.figure(figsize=(10,10))
plt.plot(df['time'], df['temp'])
plt.show()

df.info()

data = df[['time', 'temp']]
#deleting all the missing values from the temp column
data.dropna(inplace=True)
data.columns = ['ds', 'y']
data.head()

data.info()

"""# **Training The Model**"""

model = NeuralProphet()
model.fit(data, freq='H', epochs=1000)

"""RMSE = 2.7, which means the model is off by almost 3 degrees

# Forecasting
"""

future = model.make_future_dataframe(data, periods=3803)
forecast = model.predict(future)
forecast.tail()

plot1 = model.plot(forecast)
plot1.show()

plot2 = model.plot_components(forecast)
plot2.show()

